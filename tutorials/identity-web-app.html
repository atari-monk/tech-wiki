<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="author" content="atari-monk" />
        <meta name="description" content="Tutorial page of my tech wiki." />
        <title>Tech Wiki Web Page</title>
        <link rel="icon" href="../images/html5.png" type="image/x-icon" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" />
        <script src="../js/tutorial.js"></script>
    </head>

    <body>
        <header>
            <h1 class="title">Identity web app.</h1>
            <nav aria-label="primary-navigation">
                <ul>
                    <li class="list-point">
                        <a href="#source">Source</a>
                    </li class="list-point">
                    <li class="list-point">
                        <a href="#desc">Description</a>
                    </li class="list-point">
                    <li class="list-point">
                        <a href="#prerequisites">Prerequisites/Assumptions</a>
                    </li class="list-point">
                    <li class="list-point">
                        <a href="#tutorial">Tutorial</a>
                    </li class="list-point">
                    <li class="list-point">
                        <a href="#summary">Summary</a>
                    </li>
                </ul>
            </nav>
        </header>
        <hr />
        <main>
            <article id="source">
                <h2>Source</h2>
                <section class="list-point">
                    <ol>
                        <li class="list-point">
                            <a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/identity?view=aspnetcore-7.0&tabs=netcore-cli">Source tutorial</a>
                        </li>
                        <li class="list-point">
                            <a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/scaffold-identity?view=aspnetcore-7.0&tabs=netcore-cli">Additional tutorial</a>
                        </li>
                    </ol>
                </section>
            </article>
            <article id="desc">
                <h2>Description</h2>
                <section>
                    <p>
                        Asp.Net Core MVC Web app with identity authentication/authorization system.
                    </p>
                </section>
            </article>
            <article id="prerequisites">
                <h2>Prerequisites/Assumptions</h2>
                <section>
                    <ol>
                        <li class="list-point">Azure account</li>
                        <li class="list-point">VSCode</li>
                    </ol>
                </section>
            </article>
            <article id="tutorial">
                <h2>Tutorial</h2>
                <section>
                    <ol>
                        <li>
                            <p>
                                Create new github repo.<br>Here using github portal.<br>Open in VSCode.
                            </p>
                            <aside>
                                <details>
                                    <summary>details</summary>
                                    <p><mark class="mark-name">repo name</mark></p>
                                </details>
                            </aside>
                            <p>
                                <button onclick="Copy('code1')">Copy</button>
                                <code id='code1'>
                                    identity-web-app
                                </code>
                                <br>
                                <button onclick="Copy('code2')">Copy</button>
                                <code id='code2'>
                                    cd C:\atari-monk\Code
                                </code>
                                <br>
                                <button onclick="Copy('code3')">Copy</button>
                                <code id='code3'>
                                    git clone https://github.com/atari-monk/identity-web-app.git
                                </code>
                                <br>
                                <button onclick="Copy('code4')">Copy</button>
                                <code id='code4'>
                                    cd identity-web-app
                                </code>
                                <br>
                                <button onclick="Copy('code5')">Copy</button>
                                <code id='code5'>
                                    code .
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Generate web app with identity.
                            </p>
                            <aside>
                                <details>
                                    <summary>details</summary>
                                    <p><mark class="mark-desc">optional to check options</mark></p>
                                    <p><mark class="mark-desc">This uses LocalDb. There is option with SQLite</mark></p>
                                </details>
                            </aside>
                            <p>
                                <button onclick="Copy('code6')">Copy</button>
                                <code id='code6'>
                                    dotnet new list
                                </code>
                                <br>
                                <button onclick="Copy('code7')">Copy</button>
                                <code id='code7'>
                                    dotnet new mvc --auth Individual -uld -n Identity.WebApp
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Setup project. Restart VSCode (for some reason it needs it).
                            </p>
                            <p>
                                <button onclick="Copy('code8')">Copy</button>
                                <code id='code8'>
                                    dotnet new sln
                                </code>
                                <br>
                                <button onclick="Copy('code9')">Copy</button>
                                <code id='code9'>
                                    dotnet sln add Identity.WebApp
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                VSCode should add it's json configs. Optionally add them to ignore, to not commit it.
                            </p>
                            <aside>
                                <details>
                                    <summary>details</summary>
                                    <p><mark class="mark-desc">add to .gitignore</mark></p>
                                </details>
                            </aside>
                            <p>
                                <button onclick="Copy('code10')">Copy</button>
                                <code id='code10'>
                                    *.vscode
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Do migrations.
                            </p>
                            <p>
                                <button onclick="Copy('code11')">Copy</button>
                                <code id='code11'>
                                    dotnet tool update --global dotnet-ef
                                </code>
                                <br>
                                <button onclick="Copy('code12')">Copy</button>
                                <code id='code12'>
                                    cd .\Identity.WebApp\
                                </code>
                                <br>
                                <button onclick="Copy('code13')">Copy</button>
                                <code id='code13'>
                                    dotnet ef database update
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Run the app and register a user and login. (With debugger and/or without).
                            </p>
                            <p>
                                <button onclick="Copy('code14')">Copy</button>
                                <code id='code14'>
                                    dotnet run
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Configure Identity services.<br>I copied default settings from msdocs and put it in class invoked in program.cs.<br>It's refactored to better readability.
                            </p>
                            <p>
                            </p>
                        </li>
                        <li>
                            <p>
                                Add db connection string buider, with help of <a href="./nuget.html">Nuget</a> and <a href="./azure-secrets.html">Azure Secrets</a>.
                            </p>
                            <p>
                            </p>
                        </li>
                        <li>
                            <p>
                                Scaffold Identity UI. Use commands you acctualy need for this. Below some set.
                            </p>
                            <aside>
                                <details>
                                    <summary>details</summary>
                                    <p><mark class="mark-desc">this should generate all available UI</mark></p>
                                </details>
                            </aside>
                            <p>
                                <button onclick="Copy('code15')">Copy</button>
                                <code id='code15'>
                                    dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
                                </code>
                                <br>
                                <button onclick="Copy('code16')">Copy</button>
                                <code id='code16'>
                                    dotnet add package Microsoft.EntityFrameworkCore.Design
                                </code>
                                <br>
                                <button onclick="Copy('code17')">Copy</button>
                                <code id='code17'>
                                    dotnet add package Microsoft.AspNetCore.Identity.EntityFrameworkCore
                                </code>
                                <br>
                                <button onclick="Copy('code18')">Copy</button>
                                <code id='code18'>
                                    dotnet add package Microsoft.AspNetCore.Identity.UI
                                </code>
                                <br>
                                <button onclick="Copy('code19')">Copy</button>
                                <code id='code19'>
                                    dotnet add package Microsoft.EntityFrameworkCore.SqlServer
                                </code>
                                <br>
                                <button onclick="Copy('code20')">Copy</button>
                                <code id='code20'>
                                    dotnet add package Microsoft.EntityFrameworkCore.Tools
                                </code>
                                <br>
                                <button onclick="Copy('code21')">Copy</button>
                                <code id='code21'>
                                    dotnet tool install -g dotnet-aspnet-codegenerator
                                </code>
                                <br>
                                <button onclick="Copy('code22')">Copy</button>
                                <code id='code22'>
                                    dotnet tool update -g dotnet-aspnet-codegenerator
                                </code>
                                <br>
                                <button onclick="Copy('code23')">Copy</button>
                                <code id='code23'>
                                    dotnet aspnet-codegenerator identity -h
                                </code>
                                <br>
                                <button onclick="Copy('code24')">Copy</button>
                                <code id='code24'>
                                    dotnet aspnet-codegenerator identity -dc Identity.WebApp.Data.ApplicationDbContext
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Error thrown.
                            </p>
                            <p>
                                <button onclick="Copy('code1')">Copy</button>
                                <code id='code1'>
                                    Cannot use an existing DbContext with the '--useDefaultUI' option
                                </code>
                                <br>
                            </p>
                        </li>
                        <li>
                            <p>
                                Removed --useDefaultUI from command. Fixed error.
                            </p>
                            <p>
                            </p>
                        </li>                           
                    </ol>
                </section>
            </article>
            <article id="summary">
                <h2>Summary</h2>
                <summary>
                    I dont know yet.
                </summary>
            </article>
        </main>
        <hr />
        <footer>
            <p>
                &lt;&lt;&lt;
                <a href="https://github.com/atari-monk">atari-monk</a>
                &gt;&gt;&gt;
            </p>
            <p>
                <a href="#">Back to Top</a>
            </p>
        </footer>
    </body>
</html>
